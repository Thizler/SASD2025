timelines : 10:00 - 30:00  
link : https://www.youtube.com/watch?v=6wDoopbtEqk

# Refactoring เพื่อแก้ Code Smells
Fowler เน้นปัญหาใหญ่คือ Long Function (ฟังก์ชันยาว อ่านยาก)
เป้าหมายคือ "ทำให้โค้ดสะอาดขึ้นโดยไม่เปลี่ยนพฤติกรรมโปรแกรม"
## 1. Extract Function
แยกฟังก์ชันย่อยออกจากฟังก์ชันหลัก
โดยเฉพาะส่วนที่มี switch ตามประเภทละคร
ทำไมต้องแยก?
ฟังก์ชันหลักอ่านง่ายขึ้น
จัดการ logic เฉพาะทางได้ชัดเจน
ลดโค้ดยาวเกินไป
ข้อควรระวัง: ต้องจัดการกับตัวแปร local เช่น
perf, play ที่ถูกใช้ข้ามหลายบรรทัด

## 2. Rename Variable
เปลี่ยนชื่อให้โค้ด "สื่อสารได้ดีขึ้น"
ตัวอย่างที่ Fowler ทำ:
thisAmount → result (มาตรฐานว่าค่าที่ฟังก์ชันส่งกลับ)
perf → aPerformance (บอกชนิดข้อมูลชัดเจนขึ้น)
ผลลัพธ์: โค้ดอ่านแล้วรู้ทันทีว่าตัวแปรเก็บอะไร

## 3. Replace Temp with Query
ลบ ตัวแปรชั่วคราว (Temporary Variable) เช่น play
แล้วเปลี่ยนเป็นการเรียกฟังก์ชันแทน เช่น playFor(perf)

เหตุผล:
ลด dependency ระหว่างตัวแปร
ง่ายต่อการแยกฟังก์ชันและจัดกลุ่ม logic
Fowler บอกว่าไม่ต้องกังวลเรื่อง performance ตอนนี้
→ ทำโค้ดให้สะอาดก่อน แล้วค่อย profiling หาจุดช้าทีหลัง

## 4. Split Loop
แยกลูปที่ทำหลายงาน (เช่น คิดเงิน + คิดคะแนนสะสม) ออกจากกัน เช่น
ลูป A → คำนวณราคา
ลูป B → คำนวณคะแนน
ทำไมต้องแยก?
ทำให้ Extract Function ได้ง่ายขึ้น
ลด logic ที่ซับซ้อนปะปนกัน
ทำโค้ดอ่านง่ายขึ้นมาก

## "Refactoring ควรทำแบบก้าวเล็ก ๆ โดยไม่ทำให้พฤติกรรมโปรแกรมเปลี่ยน"
และเป้าหมายคือ: โค้ดภายในสวยงาม พร้อมรองรับ future feature เช่น
rendering แบบ HTML เพิ่มประเภทละครใหม่ เป็นต้น
